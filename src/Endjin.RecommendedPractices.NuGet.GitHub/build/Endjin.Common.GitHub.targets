<Project ToolsVersion="14.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">

    <!--
        These properties would normally be set during the MSBuild evalution phase, so you'd
        expect them to go in a .props file. However, we're using a Task to retrieve the
        GitHub repo details, and you can only run tasks in a Target. So we have to
        set all these NuGet properties during the Target execution phase. We make this
        run before Compile because the Compile Target runs some code generation tasks
        that will in some circumstances attempt to use some of these properties.
    -->
    <Target Name="_EndjinSetGitHubProperties" BeforeTargets="Compile" DependsOn="EndjinDetectGitHub">
        <PropertyGroup>
            <GitHubOrg>$([System.Text.RegularExpressions.Regex]::Match($(EndjinRepositoryUrl), `https://github.com/([^/]*)/([^/]*)`).Groups[1].Value)</GitHubOrg>
            <GitHubProject>$([System.Text.RegularExpressions.Regex]::Match($(EndjinRepositoryUrl), `https://github.com/([^/]*)/([^/]*)`).Groups[2].Value)</GitHubProject>
        </PropertyGroup>

        <PropertyGroup>
            <RepositoryUrl>https://github.com/$(GitHubOrg)/$(GitHubProject).git</RepositoryUrl>
            <PackageProjectUrl>https://github.com/$(GitHubOrg)/$(GitHubProject)</PackageProjectUrl>
            <PackageReleaseNotes>See https://github.com/$(GitHubOrg)/$(GitHubProject)/releases/</PackageReleaseNotes>

            <RepositoryType>git</RepositoryType>
        </PropertyGroup>
    </Target>

</Project>